# Tasks: 素材库与模版库系统实现

## Phase 1: 数据基础设施 (P0)

### 1.1 数据模型扩展
- [x] 1.1.1 新增 Template 模型（type, name, parameters JSON, source）
- [x] 1.1.2 新增 UserFavorite 模型（userId, targetId, targetType）
- [x] 1.1.3 新增 StickerPack / Sticker 模型
- [x] 1.1.4 扩展 Media 模型添加 source 字段
- [x] 1.1.5 运行数据库迁移

### 1.2 API 层
- [x] 1.2.1 实现收藏 API（添加/取消收藏、获取收藏列表）
- [x] 1.2.2 实现模版 CRUD API
- [ ] 1.2.3 实现表情包 API

## Phase 2: 素材库增强 (P0-P1)

### 2.1 收藏功能
- [ ] 2.1.1 素材库新增「我的收藏」Tab
- [ ] 2.1.2 素材卡片添加收藏按钮
- [ ] 2.1.3 收藏状态实时同步
- [ ] 2.1.4 模版库同步实现收藏功能

### 2.2 交互增强
- [ ] 2.2.1 实现视频首帧封面截取（上传时自动生成）
- [ ] 2.2.2 实现悬浮预览（视频自动播放）
- [ ] 2.2.3 实现悬浮预览（音频波形显示）
- [ ] 2.2.4 优化点击放大预览弹窗

### 2.3 表情包管理
- [ ] 2.3.1 表情包列表展示组件
- [ ] 2.3.2 表情包导入功能（zip/单图/URL）
- [ ] 2.3.3 表情包分组管理

## Phase 3: 花字模版系统 (P0-P1)

### 3.1 花字模版数据结构
- [x] 3.1.1 定义 FancyTextTemplate 类型接口
- [x] 3.1.2 定义整体参数（文字、颜色、字体、动画等）
- [x] 3.1.3 定义逐字参数（高低、远近、旋转等）
- [x] 3.1.4 创建系统预设花字模版数据

### 3.2 花字渲染引擎
- [x] 3.2.1 创建渲染器基础架构（使用 Framer Motion）
- [x] 3.2.2 实现文字渲染（支持多字体、渐变、描边）
- [x] 3.2.3 实现入场动画系统（18+ 动画类型）
- [x] 3.2.4 实现循环动画系统（12+ 动画类型）
- [x] 3.2.5 实现退场动画系统（8+ 动画类型）
- [x] 3.2.6 实现逐字动画控制
- [x] 3.2.7 实现装饰元素渲染（粒子、图标等）
- [ ] 3.2.8 实现音效同步播放

### 3.3 花字模版编辑器
- [ ] 3.3.1 创建模版参数编辑面板
- [ ] 3.3.2 实现颜色选择器（支持渐变）
- [ ] 3.3.3 实现字体选择器（带预览）
- [ ] 3.3.4 实现动画选择器（带预览）
- [ ] 3.3.5 实现逐字参数编辑器
- [ ] 3.3.6 实现实时预览

### 3.4 花字用途标签
- [ ] 3.4.1 定义用途标签枚举（标题、章节、指引等）
- [ ] 3.4.2 实现用途标签筛选
- [ ] 3.4.3 用途标签关联推荐

## Phase 4: 模版库页面 (P1)

### 4.1 模版库重构
- [x] 4.1.1 模版库 Tab 结构（全部/系统/我的/收藏/AI/灵感）
- [x] 4.1.2 模版卡片组件（支持悬浮预览）
- [x] 4.1.3 模版详情弹窗
- [ ] 4.1.4 模版参数编辑弹窗

### 4.2 从模版生成素材
- [ ] 4.2.1 实现模版渲染 API
- [ ] 4.2.2 实现渲染队列管理
- [ ] 4.2.3 渲染进度展示
- [ ] 4.2.4 生成素材自动保存到用户库

## Phase 5: 灵感创意功能 (P2)

### 5.1 灵感创意表单
- [ ] 5.1.1 创建灵感创意页面入口
- [ ] 5.1.2 实现文字输入
- [ ] 5.1.3 实现字体风格选择（带预览）
- [ ] 5.1.4 实现视觉风格多选
- [ ] 5.1.5 实现质感选择
- [ ] 5.1.6 实现动画组合选择
- [ ] 5.1.7 实现时长设置
- [ ] 5.1.8 实现场景用途选择
- [ ] 5.1.9 实现附加要求多选

### 5.2 AI 生成花字
- [ ] 5.2.1 表单数据转模版脚本
- [ ] 5.2.2 随机参数组合算法
- [ ] 5.2.3 实时预览生成
- [ ] 5.2.4 保存到用户模版库

## Phase 6: AI 能力集成 (P3)

### 6.1 AI 素材召唤
- [ ] 6.1.1 设计 AI 召唤入口
- [ ] 6.1.2 实现素材源适配器（Pexels、Pixabay等）
- [ ] 6.1.3 实现搜索结果展示
- [ ] 6.1.4 实现素材导入流程

### 6.2 AI 模版生成
- [ ] 6.2.1 设计 AI 模版生成入口
- [ ] 6.2.2 实现 Google Veo 视频生成适配
- [ ] 6.2.3 实现 Google Imagen 图片生成适配
- [ ] 6.2.4 生成结果预览与导入

## Phase 7: 视频/图片模版 (P3)

### 7.1 视频模版
- [ ] 7.1.1 人物区域标注工具
- [ ] 7.1.2 人物替换渲染
- [ ] 7.1.3 背景替换渲染
- [ ] 7.1.4 变速曲线编辑器

### 7.2 图片模版
- [ ] 7.2.1 人物区域蒙版工具
- [ ] 7.2.2 人物替换合成
- [ ] 7.2.3 背景替换合成

